<div class="view-childs-page">
  <section class="notes">
    <h3>Key Notes (ViewChild/Children)</h3>
    <ul>
      <li>@ViewChild access is guaranteed after <code>ngAfterViewInit</code>; use a template reference (#ref).</li>
      <li>@ViewChildren returns a <code>QueryList</code> and tracks dynamic changes.</li>
      <li>Direct DOM manipulation via ElementRef can be unsafe; prefer Renderer2 when possible.</li>
      <li>Overusing child component APIs can create tight coupling.</li>
    </ul>
    <h4>Pros</h4>
    <ul>
      <li>Direct control of child components/elements.</li>
      <li>Convenient bulk operations (ViewChildren).</li>
    </ul>
    <h4>Cons</h4>
    <ul>
      <li>Tighter coupling can hurt reuse and testing.</li>
      <li>Wrong lifecycle usage can cause null reference errors.</li>
    </ul>
  </section>
  <h2>Angular ViewChild and ViewChildren Examples</h2>
  <p>This page demonstrates how to use @ViewChild and @ViewChildren decorators to access child components and DOM elements from parent components.</p>

  <!-- ViewChild Examples -->
  <div class="example-section">
    <h3>@ViewChild Examples - Accessing Individual Child Components</h3>
    <p>@ViewChild allows you to access a single child component or DOM element by template reference variable.</p>
    
    <div class="viewchild-demo">
      <div class="demo-components">
        <h4>Child Components</h4>
        
        <!-- Color Box with ViewChild -->
        <div class="component-group">
          <h5>Color Box (ViewChild: #firstColorBox)</h5>
          <app-color-box
            #firstColorBox
            color="#007bff"
            size="medium"
            label="First Box"
            (clicked)="onColorBoxClicked()">
          </app-color-box>
        </div>

        <!-- Text Editor with ViewChild -->
        <div class="component-group">
          <h5>Text Editor (ViewChild: #textEditor)</h5>
          <app-text-editor
            #textEditor
            [content]="editorContent"
            placeholder="Type something here..."
            (contentChanged)="onTextEditorContentChanged($event)"
            (focusChanged)="onTextEditorFocusChanged($event)">
          </app-text-editor>
        </div>

        <!-- Progress Bar with ViewChild -->
        <div class="component-group">
          <h5>Progress Bar (ViewChild: #progressBar)</h5>
          <app-progress-bar
            #progressBar
            [value]="progressValue"
            [max]="maxProgress"
            label="Main Progress"
            (progressComplete)="onProgressBarComplete()"
            (valueChanged)="onProgressBarValueChanged($event)">
          </app-progress-bar>
        </div>

        <!-- DOM Element with ViewChild -->
        <div class="component-group">
          <h5>DOM Element (ViewChild: #demoElement)</h5>
          <div #demoElement class="demo-element" [class]="'demo-element-' + (selectedColor ? 'colored' : 'default')">
            This is a DOM element accessed via ViewChild
          </div>
        </div>
      </div>

      <div class="viewchild-controls">
        <h4>ViewChild Controls</h4>
        
        <div class="control-group">
          <h5>Color Box Controls</h5>
          <button (click)="changeFirstColorBoxColor()" class="btn btn-primary">Random Color</button>
          <button (click)="activateFirstColorBox()" class="btn btn-success">Activate</button>
          <button (click)="deactivateFirstColorBox()" class="btn btn-warning">Deactivate</button>
        </div>

        <div class="control-group">
          <h5>Text Editor Controls</h5>
          <button (click)="focusTextEditor()" class="btn btn-primary">Focus</button>
          <button (click)="clearTextEditor()" class="btn btn-danger">Clear</button>
          <button (click)="selectAllText()" class="btn btn-info">Select All</button>
          <button (click)="insertTextInEditor()" class="btn btn-secondary">Insert Text</button>
        </div>

        <div class="control-group">
          <h5>Progress Bar Controls</h5>
          <button (click)="incrementProgress()" class="btn btn-success">+10</button>
          <button (click)="decrementProgress()" class="btn btn-warning">-10</button>
          <button (click)="resetProgress()" class="btn btn-danger">Reset</button>
          <button (click)="completeProgress()" class="btn btn-primary">Complete</button>
        </div>

        <div class="control-group">
          <h5>DOM Element Info</h5>
          <button (click)="logEvent('DOM Element Info: ' + JSON.stringify(getElementInfo()))" class="btn btn-info">Get Element Info</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ViewChildren Examples -->
  <div class="example-section">
    <h3>@ViewChildren Examples - Accessing Multiple Child Components</h3>
    <p>@ViewChildren allows you to access multiple child components of the same type using QueryList.</p>
    
    <div class="viewchildren-demo">
      <div class="demo-components">
        <h4>Multiple Child Components</h4>
        
        <!-- Multiple Color Boxes -->
        <div class="component-group">
          <h5>Color Boxes (ViewChildren: ColorBoxComponent)</h5>
          <div class="color-boxes-grid">
            <app-color-box
              *ngFor="let color of ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3']; let i = index"
              [color]="color"
              size="small"
              [label]="'Box ' + (i + 1)"
              (clicked)="onColorBoxClicked()">
            </app-color-box>
          </div>
        </div>

        <!-- Multiple Text Editors -->
        <div class="component-group">
          <h5>Text Editors (ViewChildren: TextEditorComponent)</h5>
          <div class="text-editors-grid">
            <app-text-editor
              *ngFor="let i of [1, 2, 3]"
              [content]="'Editor ' + i + ' content'"
              [placeholder]="'Editor ' + i + ' placeholder'"
              (contentChanged)="onTextEditorContentChanged($event)"
              (focusChanged)="onTextEditorFocusChanged($event)">
            </app-text-editor>
          </div>
        </div>

        <!-- Multiple Progress Bars -->
        <div class="component-group">
          <h5>Progress Bars (ViewChildren: ProgressBarComponent)</h5>
          <div class="progress-bars-grid">
            <app-progress-bar
              *ngFor="let value of [20, 50, 80]"
              [value]="value"
              [max]="100"
              [label]="'Progress ' + value + '%'"
              (progressComplete)="onProgressBarComplete()"
              (valueChanged)="onProgressBarValueChanged($event)">
            </app-progress-bar>
          </div>
        </div>
      </div>

      <div class="viewchildren-controls">
        <h4>ViewChildren Controls</h4>
        
        <div class="control-group">
          <h5>All Color Boxes</h5>
          <button (click)="activateAllColorBoxes()" class="btn btn-success">Activate All</button>
          <button (click)="deactivateAllColorBoxes()" class="btn btn-warning">Deactivate All</button>
          <button (click)="randomizeAllColors()" class="btn btn-primary">Randomize Colors</button>
        </div>

        <div class="control-group">
          <h5>All Text Editors</h5>
          <button (click)="focusAllTextEditors()" class="btn btn-primary">Focus All</button>
          <button (click)="clearAllTextEditors()" class="btn btn-danger">Clear All</button>
        </div>

        <div class="control-group">
          <h5>All Progress Bars</h5>
          <button (click)="resetAllProgressBars()" class="btn btn-danger">Reset All</button>
          <button (click)="setAllProgressBarsTo(25)" class="btn btn-info">Set to 25%</button>
          <button (click)="setAllProgressBarsTo(50)" class="btn btn-info">Set to 50%</button>
          <button (click)="setAllProgressBarsTo(75)" class="btn btn-info">Set to 75%</button>
          <button (click)="setAllProgressBarsTo(100)" class="btn btn-success">Set to 100%</button>
        </div>

        <div class="control-group">
          <h5>Auto Progress</h5>
          <button (click)="toggleAutoProgress()" class="btn" [class]="autoProgress ? 'btn-danger' : 'btn-success'">
            {{ autoProgress ? 'Stop Auto Progress' : 'Start Auto Progress' }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Event Logs -->
  <div class="example-section">
    <h3>Event Logs</h3>
    <p>View the events generated by ViewChild and ViewChildren interactions.</p>
    
    <div class="event-logs">
      <div class="event-log">
        <h4>ViewChild Events</h4>
        <div class="log-container">
          <div *ngFor="let event of viewChildEvents" class="log-item">
            {{ event }}
          </div>
          <div *ngIf="viewChildEvents.length === 0" class="no-events">
            No ViewChild events yet. Try the controls above!
          </div>
        </div>
        <button (click)="clearViewChildEvents()" class="btn btn-secondary btn-sm">Clear Events</button>
      </div>

      <div class="event-log">
        <h4>ViewChildren Events</h4>
        <div class="log-container">
          <div *ngFor="let event of viewChildrenEvents" class="log-item">
            {{ event }}
          </div>
          <div *ngIf="viewChildrenEvents.length === 0" class="no-events">
            No ViewChildren events yet. Try the controls above!
          </div>
        </div>
        <button (click)="clearViewChildrenEvents()" class="btn btn-secondary btn-sm">Clear Events</button>
      </div>
    </div>
  </div>

  <!-- Concepts Explanation -->
  <div class="example-section">
    <h3>ViewChild and ViewChildren Concepts</h3>
    <div class="concepts-grid">
      <div class="concept-card">
        <h4>@ViewChild Decorator</h4>
        <p>Access a single child component or DOM element</p>
        <ul>
          <li>Use with template reference variable (#name)</li>
          <li>Access after ngAfterViewInit lifecycle hook</li>
          <li>Returns the first matching element</li>
          <li>Useful for direct component manipulation</li>
        </ul>
        <code>@ViewChild('myComponent') myComponent!: MyComponent;</code>
      </div>
      
      <div class="concept-card">
        <h4>@ViewChildren Decorator</h4>
        <p>Access multiple child components of the same type</p>
        <ul>
          <li>Returns a QueryList of components</li>
          <li>Automatically updates when DOM changes</li>
          <li>Use forEach() to iterate over components</li>
          <li>Perfect for bulk operations</li>
        </ul>
        <code>@ViewChildren(MyComponent) myComponents!: QueryList&lt;MyComponent&gt;;</code>
      </div>
      
      <div class="concept-card">
        <h4>ElementRef</h4>
        <p>Access native DOM elements directly</p>
        <ul>
          <li>Use for DOM manipulation</li>
          <li>Access via .nativeElement property</li>
          <li>Use with caution for security</li>
          <li>Prefer Angular's Renderer2 when possible</li>
        </ul>
        <code>@ViewChild('myElement') myElement!: ElementRef;</code>
      </div>
      
      <div class="concept-card">
        <h4>QueryList</h4>
        <p>Angular's collection for ViewChildren results</p>
        <ul>
          <li>Iterable collection of components</li>
          <li>Changes observable via .changes</li>
          <li>Use .toArray() to convert to array</li>
          <li>Automatically updates with DOM changes</li>
        </ul>
        <code>this.myComponents.forEach(comp => comp.doSomething());</code>
      </div>
    </div>
  </div>
</div>
